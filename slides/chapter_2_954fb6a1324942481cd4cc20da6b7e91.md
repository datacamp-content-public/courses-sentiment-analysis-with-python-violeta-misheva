---
key: 954fb6a1324942481cd4cc20da6b7e91
title: 'Insert title here'
---

## Wrap up

```yaml
type: TitleSlide
key: d43d5a3c6c
```

`@lower_third`
name: Violeta Misheva
title: Data Scientist

`@script`
Welcome to the last video of this course on ‘Survival Analysis in Python’.

---

## Survival analysis: What?

```yaml
type: FullSlide
key: 477bbb9a84
center_content: true
```

`@part1`
> 
**The time it takes for an event of interest to occur.**

`@script`
So far, we learned what is survival (also called duration) analysis. We defined it as ‘the time it takes for an event of interest to occur’. 

We talked about where it’s used and demonstrated that with varied data sets in the exercises.

---

## Survival Analysis: Where

```yaml
type: FullSlide
key: ee265d94d9
```

`@part1`
- Medical studies: time to death, disease(recovery) {{1}}
- Engineering: time to failure {{2}}
- HR: to model absenteeism, employee turnover {{3}}
- Client applications and product analytics: churn {{4}}
- Political science: model political regimes {{5}}
- Real estate: time to sale/rent of a property {{6}}

`@script`
Concretely, survival analysis is quite common in medical studies where we may want to study the time to death, disease or to disease recovery; 

It is widespread in other areas, such as engineering where we may look at ‘time to failure’, 

HR where we can model absenteeism, or predict when an employee may leave a company, 

in any client facing application or product analytics where we may want to predict when a client is likely to churn; 

political science to analyze the end of a political regime, 

real estate to predict time to sale or renting of a property 

and others.

---

## Insert title here...

```yaml
type: TwoColumns
key: f36714ccb2
```

`@part1`
### Concepts: 
- What is a survival curve and how to interpret and visualize it? {{2}}
- What does the hazard rate tell us? {{3}}
- Censoring {{4}}

`@part2`
### Methods:
- KaplanMeier {{5}}
- Weibul, Exponential, other parametric {{6}}
- Cox Proportional hazard {{7}}

`@script`
Important concepts we learned are: 

What is a survival curve and how to interpret and visualize it
What does the hazard rate tell us?
We also saw that censoring was practically always present


What methods did we explore? 

We worked with non-parametric models such as Kaplan-Meier and compared two survival curves of different populations; 

We also built parametric models using the Weibull and Exponential distributions and saw some other options, and discussed how to choose a model. 

Last but not least, we trained a model using a Cox Proportional hazard. We learned to interpret its performance  and features, and tested whether the  proportional hazard assumption holds.

---

## Cox PH to model turnover

```yaml
type: FullSlide
key: 794053f1b7
```

`@part1`
```
from lifelines import CoxPHFitter 
```
{{1}}

```
cph = CoxPHFitter() 
cph.fit(train, duration_col='stag', event_col='event')
```
{{2}}

```
cph.print_summary()
```
{{3}}

![model summary](https://assets.datacamp.com/production/repositories/4394/datasets/b31ff71c2ad33e205f4dbef17e27d656b87ee686/snippet%20model%20summary.png = 50) {{4}}

`@script`
Let’s finish this chapter with a last piece of coding. We continue working with the employee turnover data. As a reminder, we can train a Cox Proportional hazard on it using the lifelines package where again we have used around 80% of the data as a training set, the rest- as a test set. Also, remember that the duration of employment at the company (in months) was given by ‘stag’ and the ‘event’ column is 1 if the employee left and 0 otherwise. 

We can check the performance of the model and see an output of the coefficients calling the .print_summary() method.

---

## Plot of the features

```yaml
type: FullSlide
key: e06789e58c
```

`@part1`
```
cph.plot()
```
{{1}}
![](https://assets.datacamp.com/production/repositories/4394/datasets/a9dc586fea33c1c793d8511efa04a124e7a4492e/features%20train%20CPH.png){{2}}

`@script`
We discussed in an earlier video how to plot and interpret the coefficients of a Cox Proportional Hazard model. 

Here is a reminder for you on how to obtain them.

---

## Predicting the survival function

```yaml
type: FullSlide
key: b0a94f3808
```

`@part1`
```
surv_fn = cph.predict_survival_function(test)
```
{{1}}

![](https://assets.datacamp.com/production/repositories/4394/datasets/2e8cb727ac3d55d6a8448607a23d9739a5ba8796/predicted%20survival%20rates%20for%202%20employees.png) {{2}}

`@script`
We can also predict the survival function for each employee, i.e. the probability that each employee will leave in each month. We are predicting the survival function on the test set, mimicking a real world scenario where you may need to predict which of your customers or employees will leave next month provided they have stayed this far – an outcome you don’t know in advance. 

We see on the plot the survival functions for two different employees for both of whom our model performs poorly. The red curve is for an employee for which the difference between the predicted and the real duration was the largest, and the blue- the smallest.

---

## Predicting the time of leave

```yaml
type: FullSlide
key: 7bb170d9ef
```

`@part1`
```
durations = pd.concat([cph.predict_expectation(test), test.stag], axis=1)
durations.columns = ['predicted', 'observed']
durations['errors'] =  durations.predicted -durations.observed
```
{{1}}


```
mae = np.mean(np.abs(durations.errors))
print('MAE: ', mae)
```
{{2}}

```
MAE:  32.07773081657037
```
{{3}}

`@script`
How can we say the model performs poorly? Just like with any supervised learning model, we can see what is the duration the model predicted (i.e. the moment of leave) versus what really happened.

Can we make improvements on this model?

---

## Let's practice!

```yaml
type: FinalSlide
key: 4a8454c3c9
```

`@script`
Let’s try that in the exercises!
